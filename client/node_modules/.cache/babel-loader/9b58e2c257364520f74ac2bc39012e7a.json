{"ast":null,"code":"var _jsxFileName = \"/home/yoojin/Development/code/phase_5/project/client/src/Components/PostPhotos.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable jsx-a11y/alt-text */\n// @ts-nocheck\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { Error } from '../Styles/NewFilm.style'; // Styling\n\nimport { PostPhotoContainer } from '../Styles/PostPhotos.style';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction PostPhotos(_ref) {\n  _s();\n\n  let {\n    currentSlideId,\n    currentUser,\n    updatingIsReleased\n  } = _ref;\n  const [selectedImages, setSelectedImages] = useState([]);\n  const [error, setError] = useState(\"\");\n  const history = useHistory();\n  useEffect(() => {\n    if (!currentUser) {\n      fetch('/me').then(res => {\n        if (!res.ok) {\n          history.push('/loginerror');\n        }\n      });\n    }\n  }, []);\n\n  function imageHandleChange(e) {\n    if (e.target.files) {\n      const fileArray = Array.from(e.target.files).map(file => URL.createObjectURL(file));\n      setSelectedImages(images => images.concat(fileArray));\n      Array.from(e.target.files).map(file => URL.revokeObjectURL(file));\n    }\n  }\n\n  function renderPhotos(source) {\n    return source.map(photo => {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        src: photo,\n        className: \"renderedPhotos\",\n        onClick: () => renderDelete(photo)\n      }, photo, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 14\n      }, this);\n    });\n  }\n\n  function renderDelete(source) {\n    const updatedList = [...selectedImages];\n    updatedList.splice(selectedImages.indexOf(source), 1);\n    setSelectedImages(updatedList);\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    const data = new FormData();\n    const uploadingImages = e.target.image.files;\n\n    for (let i = 0; i < uploadingImages.length; i++) {\n      data.append(\"image\", e.target.image.files[i]);\n      data.append(\"slideshow_id\", currentSlideId);\n      setTimeout(() => {\n        submitToAPI(data);\n      }, 500);\n    }\n\n    setTimeout(() => {\n      handleUpdate(data);\n    }, 500);\n  }\n\n  function submitToAPI(data) {\n    fetch('/photos', {\n      method: 'POST',\n      body: data\n    }).then(res => res.json()).catch(error => console.error(error));\n  }\n\n  function handleUpdate(data) {\n    if (data) {\n      fetch(`/slideshows/${currentSlideId}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          isReleased: true\n        })\n      }).then(res => res.json()).then(res => {\n        updatingIsReleased(res);\n        history.push(`/user/${currentUser.id}`);\n      });\n    } else {\n      setError(\"Please submit photos\");\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(PostPhotoContainer, {\n    children: [error ? /*#__PURE__*/_jsxDEV(Error, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-text\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 23\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 16\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"center-grid\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: e => handleSubmit(e),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"first-column\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Choose the most epic photo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"from your travel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\" // multiple \n            ,\n            name: \"image\",\n            id: \"image\",\n            onChange: imageHandleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-container-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"image-container\",\n            children: renderPhotos(selectedImages)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"back\",\n            onClick: () => history.push(`/editfilm/${currentSlideId}`),\n            children: \"Back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"submit\",\n            children: \"Submit Film\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostPhotos, \"KpYdVQ/wOnbVqLsApF7HmKNxYhM=\", false, function () {\n  return [useHistory];\n});\n\n_c = PostPhotos;\nexport default PostPhotos;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostPhotos\");","map":{"version":3,"names":["React","useState","useEffect","useHistory","Error","PostPhotoContainer","PostPhotos","currentSlideId","currentUser","updatingIsReleased","selectedImages","setSelectedImages","error","setError","history","fetch","then","res","ok","push","imageHandleChange","e","target","files","fileArray","Array","from","map","file","URL","createObjectURL","images","concat","revokeObjectURL","renderPhotos","source","photo","renderDelete","updatedList","splice","indexOf","handleSubmit","preventDefault","data","FormData","uploadingImages","image","i","length","append","setTimeout","submitToAPI","handleUpdate","method","body","json","catch","console","headers","JSON","stringify","isReleased","id"],"sources":["/home/yoojin/Development/code/phase_5/project/client/src/Components/PostPhotos.js"],"sourcesContent":["/* eslint-disable jsx-a11y/alt-text */\n// @ts-nocheck\nimport React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { Error } from '../Styles/NewFilm.style'\n// Styling\nimport { PostPhotoContainer } from '../Styles/PostPhotos.style'\n\nfunction PostPhotos({currentSlideId, currentUser, updatingIsReleased}) {\n  \n  const [ selectedImages, setSelectedImages ] = useState([])\n  const [ error, setError ] = useState(\"\")\n\n  const history = useHistory()\n\n  useEffect(() => {\n    if (!currentUser) {\n      fetch('/me').then((res) => {\n        if (!res.ok) {\n            history.push('/loginerror')\n        }\n      })\n    }\n  }, [])\n\n  function imageHandleChange(e) {\n    if(e.target.files) {\n      const fileArray = Array.from(e.target.files).map((file) => URL.createObjectURL(file))\n      \n      setSelectedImages((images) => images.concat(fileArray))\n      Array.from(e.target.files).map(\n        (file) => URL.revokeObjectURL(file)\n      )\n    }\n  }\n\n  function renderPhotos(source) {\n    return source.map((photo) => {\n      return <img \n        src={photo} \n        key={photo} \n        className='renderedPhotos' \n        onClick={() => renderDelete(photo)}\n      />\n    })\n  }\n\n  function renderDelete(source) {\n    const updatedList = [...selectedImages]\n    updatedList.splice(selectedImages.indexOf(source), 1)\n    setSelectedImages(updatedList)\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault()\n    const data = new FormData()\n    const uploadingImages = e.target.image.files\n\n    for (let i = 0; i < uploadingImages.length; i++) {\n      data.append(\"image\", e.target.image.files[i])\n      data.append(\"slideshow_id\", currentSlideId)\n      setTimeout(() => {submitToAPI(data)}, 500)\n    }\n    setTimeout(() => {handleUpdate(data)}, 500)\n  }\n\n  function submitToAPI(data) {\n    fetch('/photos', {\n      method: 'POST',\n      body: data,\n    })\n      .then(res => res.json())\n      .catch((error) => console.error(error))\n  }\n\n  function handleUpdate(data) {\n    if (data) {\n      fetch(`/slideshows/${currentSlideId}`, {\n        method: 'PATCH',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({\n          isReleased: true\n        })\n      })\n        .then(res => res.json())\n        .then(res => {\n          updatingIsReleased(res)\n          history.push(`/user/${currentUser.id}`)\n        })\n    } else {setError(\"Please submit photos\")}\n  }\n\n  return (\n    <PostPhotoContainer>\n      {error ? <Error><div className='error-text'>{error}</div></Error> : null}\n      <div className='center-grid'>\n        <form onSubmit={(e) => handleSubmit(e)}>\n          <div className='first-column'>\n            <h2>Choose the most epic photo</h2>\n            <h2>from your travel</h2>\n            <input \n              type='file' \n              // multiple \n              name='image' \n              id='image'\n              onChange={imageHandleChange}\n            />\n          </div>\n          <div className='image-container-wrapper'>\n            <div className='image-container'>\n              {renderPhotos(selectedImages)}\n            </div>\n          </div>\n          <div className='button-grid'>\n            <button className='back' onClick={() => history.push(`/editfilm/${currentSlideId}`)}>Back</button>\n            <button type='submit' className='submit'>Submit Film</button>\n          </div>\n        </form>\n      </div>\n    </PostPhotoContainer>\n  )\n}\n\nexport default PostPhotos"],"mappings":"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"},"metadata":{},"sourceType":"module"}