{"ast":null,"code":"var _jsxFileName = \"/home/yoojin/Development/code/phase_5/project/client/src/Components/PostPhotos.js\",\n    _s = $RefreshSig$();\n\n/* eslint-disable jsx-a11y/alt-text */\n// @ts-nocheck\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { PostPhotoContainer } from '../Styles/PostPhotos.style';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction PostPhotos(_ref) {\n  _s();\n\n  let {\n    currentSlideId,\n    currentUser,\n    updatingIsReleased\n  } = _ref;\n  const [selectedImages, setSelectedImages] = useState([]);\n  const history = useHistory();\n  useEffect(() => {\n    if (!currentUser) {\n      fetch('/me').then(res => {\n        if (!res.ok) {\n          history.push('/loginerror');\n        }\n      });\n    }\n  }, []);\n\n  function imageHandleChange(e) {\n    if (e.target.files) {\n      const fileArray = Array.from(e.target.files).map(file => URL.createObjectURL(file));\n      setSelectedImages(images => images.concat(fileArray));\n      Array.from(e.target.files).map(file => URL.revokeObjectURL(file));\n    }\n  }\n\n  function renderPhotos(source) {\n    return source.map(photo => {\n      return /*#__PURE__*/_jsxDEV(\"img\", {\n        src: photo,\n        className: \"renderedPhotos\",\n        onClick: () => renderDelete(photo)\n      }, photo, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 14\n      }, this);\n    });\n  }\n\n  function renderDelete(source) {\n    const updatedList = [...selectedImages];\n    updatedList.splice(selectedImages.indexOf(source), 1);\n    setSelectedImages(updatedList);\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    const data = new FormData();\n    const uploadingImages = e.target.image.files;\n\n    for (let i = 0; i < uploadingImages.length; i++) {\n      data.append(\"image\", e.target.image.files[i]);\n      data.append(\"slideshow_id\", currentSlideId);\n      submitToAPI(data);\n    }\n\n    setTimeout(() => {\n      handleUpdate();\n    }, '500');\n  }\n\n  function submitToAPI(data) {\n    fetch('/photos', {\n      method: 'POST',\n      body: data\n    }).then(res => res.json()).catch(error => console.error(error));\n  }\n\n  function handleUpdate() {\n    fetch(`/slideshows/${currentSlideId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        isReleased: true\n      })\n    }).then(res => res.json()).then(res => {\n      updatingIsReleased(res);\n      history.push(`/user/${currentUser.id}`);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(PostPhotoContainer, {\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: e => handleSubmit(e),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"first-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Select multiple photos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          multiple: true,\n          name: \"image\",\n          id: \"image\",\n          onChange: imageHandleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"image-container-wrapper\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"image-container\",\n          children: renderPhotos(selectedImages)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"button-grid\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"back\",\n        onClick: () => history.push(`/editfilm/${currentSlideId}`),\n        children: \"Back to my page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Submit Film\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostPhotos, \"ewXHSqhcXM6WM+GQDJXl3TlBnCM=\", false, function () {\n  return [useHistory];\n});\n\n_c = PostPhotos;\nexport default PostPhotos;\n\nvar _c;\n\n$RefreshReg$(_c, \"PostPhotos\");","map":{"version":3,"names":["React","useState","useEffect","useHistory","PostPhotoContainer","PostPhotos","currentSlideId","currentUser","updatingIsReleased","selectedImages","setSelectedImages","history","fetch","then","res","ok","push","imageHandleChange","e","target","files","fileArray","Array","from","map","file","URL","createObjectURL","images","concat","revokeObjectURL","renderPhotos","source","photo","renderDelete","updatedList","splice","indexOf","handleSubmit","preventDefault","data","FormData","uploadingImages","image","i","length","append","submitToAPI","setTimeout","handleUpdate","method","body","json","catch","error","console","headers","JSON","stringify","isReleased","id"],"sources":["/home/yoojin/Development/code/phase_5/project/client/src/Components/PostPhotos.js"],"sourcesContent":["/* eslint-disable jsx-a11y/alt-text */\n// @ts-nocheck\nimport React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport { PostPhotoContainer } from '../Styles/PostPhotos.style'\n\nfunction PostPhotos({currentSlideId, currentUser, updatingIsReleased}) {\n  \n  const [selectedImages, setSelectedImages] = useState([])\n\n  const history = useHistory()\n\n  useEffect(() => {\n    if (!currentUser) {\n      fetch('/me').then((res) => {\n        if (!res.ok) {\n            history.push('/loginerror')\n        }\n      })\n    }\n  }, [])\n\n  function imageHandleChange(e) {\n    if(e.target.files) {\n      const fileArray = Array.from(e.target.files).map((file) => URL.createObjectURL(file))\n      \n      setSelectedImages((images) => images.concat(fileArray))\n      Array.from(e.target.files).map(\n        (file) => URL.revokeObjectURL(file)\n      )\n    }\n  }\n\n  function renderPhotos(source) {\n    return source.map((photo) => {\n      return <img \n        src={photo} \n        key={photo} \n        className='renderedPhotos' \n        onClick={() => renderDelete(photo)}\n      />\n    })\n  }\n\n  function renderDelete(source) {\n    const updatedList = [...selectedImages]\n    updatedList.splice(selectedImages.indexOf(source), 1)\n    setSelectedImages(updatedList)\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault()\n    const data = new FormData()\n    const uploadingImages = e.target.image.files\n\n    for (let i = 0; i < uploadingImages.length; i++) {\n      data.append(\"image\", e.target.image.files[i])\n      data.append(\"slideshow_id\", currentSlideId)\n      submitToAPI(data)\n    }\n    setTimeout(() => {handleUpdate()}, '500')\n  }\n\n  function submitToAPI(data) {\n    fetch('/photos', {\n      method: 'POST',\n      body: data,\n    })\n      .then(res => res.json())\n      .catch((error) => console.error(error))\n  }\n\n  function handleUpdate() {\n    fetch(`/slideshows/${currentSlideId}`, {\n      method: 'PATCH',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify({\n        isReleased: true\n      })\n    })\n      .then(res => res.json())\n      .then(res => {\n        updatingIsReleased(res)\n        history.push(`/user/${currentUser.id}`)\n      })\n  }\n\n  return (\n    <PostPhotoContainer>\n      <form onSubmit={(e) => handleSubmit(e)}>\n        <div className='first-row'>\n          <h2>Select multiple photos</h2>\n            <input \n              type='file' \n              multiple \n              name='image' \n              id='image'\n              onChange={imageHandleChange}\n            />\n        </div>\n        <div className='image-container-wrapper'>\n          <div className='image-container'>\n            {renderPhotos(selectedImages)}\n          </div>\n        </div>\n        <div className='button-grid'></div>\n        <button className='back' onClick={() => history.push(`/editfilm/${currentSlideId}`)}>Back to my page</button>\n          <button type='submit'>Submit Film</button>\n      </form>\n    </PostPhotoContainer>\n  )\n}\n\nexport default PostPhotos"],"mappings":"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"},"metadata":{},"sourceType":"module"}